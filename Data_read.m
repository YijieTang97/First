clear all;
L1=imread('G:\New_idea\Data\Landsat\2001_281_08oct\L71093084_08420011007_HRF_modtran_surf_ref_agd66.tif');
L2=imread('G:\New_idea\Data\Landsat\2001_290_17oct\L71093084_08420011016_HRF_modtran_surf_ref_agd66.tif');
L3=imread('G:\New_idea\Data\Landsat\2001_306_02nov\L71093084_08420011101_HRF_modtran_surf_ref_agd66.tif');
L4=imread('G:\New_idea\Data\Landsat\2001_313_09nov\L71093084_08420011108_HRF_modtran_surf_ref_agd66.tif');
L5=imread('G:\New_idea\Data\Landsat\2001_329_25nov\L71093084_08420011124_HRF_modtran_surf_ref_agd66.tif');
L6=imread('G:\New_idea\Data\Landsat\2001_338_04dec\L71093084_08420011203_HRF_modtran_surf_ref.tif');
L7=imread('G:\New_idea\Data\Landsat\2002_005_05jan\L71093084_08420020104_HRF_modtran_surf_ref.tif');
L8=imread('G:\New_idea\Data\Landsat\2002_012_12jan\L71093084_08420020111_HRF_modtran_surf_ref.tif');
L9=imread('G:\New_idea\Data\Landsat\2002_044_13feb\L71093084_08420020212_HRF_modtran_surf_ref.tif');
L10=imread('G:\New_idea\Data\Landsat\2002_053_22feb\L71093084_08420020221_HRF_modtran_surf_ref.tif');
L11=imread('G:\New_idea\Data\Landsat\2002_069_10mar\L72093084_08420020309_HRF_modtran_surf_ref.tif');
L12=imread('G:\New_idea\Data\Landsat\2002_076_17mar\L71093084_08420020316_HRF_modtran_surf_ref.tif');
L13=imread('G:\New_idea\Data\Landsat\2002_092_02apr\L71093084_08420020401_HRF_modtran_surf_ref.tif');
L14=imread('G:\New_idea\Data\Landsat\2002_101_11apr\L71093084_08420020410_HRF_modtran_surf_ref.tif');
L15=imread('G:\New_idea\Data\Landsat\2002_108_18apr\L71093084_08420020417_HRF_modtran_surf_ref.tif');
L16=imread('G:\New_idea\Data\Landsat\2002_117_27apr\L71093084_08420020426_HRF_modtran_surf_ref.tif');
L17=imread('G:\New_idea\Data\Landsat\2002_124_04may\L71093084_08420020503_HRF_modtran_surf_ref.tif');
M1=imread('G:\New_idea\Data\MODIS\2001_281_08oct\MOD09GA_A2001281.sur_refl.tif');
M2=imread('G:\New_idea\Data\MODIS\2001_290_17oct\MOD09GA_A2001290.sur_refl.tif');
M3=imread('G:\New_idea\Data\MODIS\2001_306_02nov\MOD09GA_A2001306.sur_refl.tif');
M4=imread('G:\New_idea\Data\MODIS\2001_313_09nov\MOD09GA_A2001313.sur_refl.tif');
M5=imread('G:\New_idea\Data\MODIS\2001_329_25nov\MOD09GA_A2001329.tif');
M6=imread('G:\New_idea\Data\MODIS\2001_338_04dec\MOD09GA_A2001338.tif');
M7=imread('G:\New_idea\Data\MODIS\2002_005_05jan\MOD09GA_A2002005.tif');
M8=imread('G:\New_idea\Data\MODIS\2002_012_12jan\MOD09GA_A2002012.tif');
M9=imread('G:\New_idea\Data\MODIS\2002_044_13feb\MOD09GA_A2002044.tif');
M10=imread('G:\New_idea\Data\MODIS\2002_053_22feb\MOD09GA_A2002053.tif');
M11=imread('G:\New_idea\Data\MODIS\2002_069_10mar\MOD09GA_A2002069.tif');
M12=imread('G:\New_idea\Data\MODIS\2002_076_17mar\MOD09GA_A2002076.tif');
M13=imread('G:\New_idea\Data\MODIS\2002_092_02apr\MOD09GA_A2002092.tif');
M14=imread('G:\New_idea\Data\MODIS\2002_101_11apr\MOD09GA_A2002101.tif');
M15=imread('G:\New_idea\Data\MODIS\2002_108_18apr\MOD09GA_A2002108.tif');
M16=imread('G:\New_idea\Data\MODIS\2002_117_27apr\MOD09GA_A2002117.tif');
M17=imread('G:\New_idea\Data\MODIS\2002_124_04may\MOD09GA_A2002124.tif');


Line1=712;
Line2=1511;
Col1=708;
Col2=1507;
Landsat1=double(L1(Line1:Line2,Col1:Col2,:))/10000;
Landsat2=double(L2(Line1:Line2,Col1:Col2,:))/10000;
Landsat3=double(L3(Line1:Line2,Col1:Col2,:))/10000;
Landsat4=double(L4(Line1:Line2,Col1:Col2,:))/10000;
Landsat5=double(L5(Line1:Line2,Col1:Col2,:))/10000;
Landsat6=double(L6(Line1:Line2,Col1:Col2,:))/10000;
Landsat7=double(L7(Line1:Line2,Col1:Col2,:))/10000;
Landsat8=double(L8(Line1:Line2,Col1:Col2,:))/10000;
Landsat9=double(L9(Line1:Line2,Col1:Col2,:))/10000;
Landsat10=double(L10(Line1:Line2,Col1:Col2,:))/10000;
Landsat11=double(L11(Line1:Line2,Col1:Col2,:))/10000;
Landsat12=double(L12(Line1:Line2,Col1:Col2,:))/10000;
Landsat13=double(L13(Line1:Line2,Col1:Col2,:))/10000;
Landsat14=double(L14(Line1:Line2,Col1:Col2,:))/10000;
Landsat15=double(L15(Line1:Line2,Col1:Col2,:))/10000;
Landsat16=double(L16(Line1:Line2,Col1:Col2,:))/10000;
Landsat17=double(L17(Line1:Line2,Col1:Col2,:))/10000;
MM1=double(M1(Line1:Line2,Col1:Col2,:))/10000;
MM2=double(M2(Line1:Line2,Col1:Col2,:))/10000;
MM3=double(M3(Line1:Line2,Col1:Col2,:))/10000;
MM4=double(M4(Line1:Line2,Col1:Col2,:))/10000;
MM5=double(M5(Line1:Line2,Col1:Col2,:))/10000;
MM6=double(M6(Line1:Line2,Col1:Col2,:))/10000;
MM7=double(M7(Line1:Line2,Col1:Col2,:))/10000;
MM8=double(M8(Line1:Line2,Col1:Col2,:))/10000;
MM9=double(M9(Line1:Line2,Col1:Col2,:))/10000;
MM10=double(M10(Line1:Line2,Col1:Col2,:))/10000;
MM11=double(M11(Line1:Line2,Col1:Col2,:))/10000;
MM12=double(M12(Line1:Line2,Col1:Col2,:))/10000;
MM13=double(M13(Line1:Line2,Col1:Col2,:))/10000;
MM14=double(M14(Line1:Line2,Col1:Col2,:))/10000;
MM15=double(M15(Line1:Line2,Col1:Col2,:))/10000;
MM16=double(M16(Line1:Line2,Col1:Col2,:))/10000;
MM17=double(M17(Line1:Line2,Col1:Col2,:))/10000;

w=1;
s=20;
PSFh=zeros((2*w+1)*s,(2*w+1)*s);PSFh(w*s+1:w*s+s,w*s+1:w*s+s)=1/s^2;
MM1=dowmsample_cube(MM1,s,w,PSFh);
MM2=dowmsample_cube(MM2,s,w,PSFh);
MM3=dowmsample_cube(MM3,s,w,PSFh);
MM4=dowmsample_cube(MM4,s,w,PSFh);
MM5=dowmsample_cube(MM5,s,w,PSFh);
MM6=dowmsample_cube(MM6,s,w,PSFh);
MM7=dowmsample_cube(MM7,s,w,PSFh);
MM8=dowmsample_cube(MM8,s,w,PSFh);
MM9=dowmsample_cube(MM9,s,w,PSFh);
MM10=dowmsample_cube(MM10,s,w,PSFh);
MM11=dowmsample_cube(MM11,s,w,PSFh);
MM12=dowmsample_cube(MM12,s,w,PSFh);
MM13=dowmsample_cube(MM13,s,w,PSFh);
MM14=dowmsample_cube(MM14,s,w,PSFh);
MM15=dowmsample_cube(MM15,s,w,PSFh);
MM16=dowmsample_cube(MM16,s,w,PSFh);
MM17=dowmsample_cube(MM17,s,w,PSFh);